<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="login.css">
</head>
<body>

<div class="login-container">

  <!-- Header -->
  <div class="top-bar">
    <span class="back">‚Üê</span>
    <h2 class="pe-title" ></h2>
  </div>

  <!-- Logo -->
  <div class="logo">
   
     <img src="./images/logo-transparent.png" class="top-logo" alt="PE WALLET">
  </div>

  <!-- Welcome -->
  <h1>Welcome Back!</h1>
  <p class="subtitle">Enter your registered account to sign in</p>

  <!-- Username -->
  <div class="input-box">
    <label>phone</label>
    <input id="m" type="text" placeholder="Enter your phone">
  </div>

  <!-- Password -->
  <div class="input-box">
    <div class="row">
      <label>Password</label>
      <a href="forgot.html" class="forgot">Forget password ?</a>
    </div>
    <input id="p" type="password" placeholder="Enter Your Password">
  </div>

  <!-- Remember -->
  <div class="remember">
    <input type="checkbox">
    <span>Remember password</span>
  </div>

  <!-- Captcha -->
 
  <!-- Button -->
  <button class="login-btn" onclick="login()" type="button" >Sign in with Account</button>
 
<div class="register-box">
  <span>Don't have an account?</span>
  <a href="register.html">Register Now</a>
</div>

  <!-- Bottom -->
  <p class="more">More login methods</p>
  <div class="methods">
    <span class="active">Phone Number</span>
    <span>Username</span>
  
  </div>

</div>

<script src="login.js"></script>

<script>
let cid="";
fetch("/captcha")
  .then(r=>r.json())
  .then(d=>{
    cid=d.id;
    document.getElementById("q").innerText=d.q;
  });

function login(){
  fetch("/login",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      mobile: m.value,
      password: p.value,
      cid: cid,
      ans: a.value
    })
  })
  .then(r=>r.json())
  .then(d=>{
    if(d.ok){
      localStorage.setItem("userPassword", p.value);
      localStorage.setItem("isLoggedIn", "true"); 
      window.location.href="dashboard.html";
    }else{
      alert(d.msg);
    }
  });
}

document.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(window.location.search);
  const invite = params.get("invite");

  if (invite) {
    const input = document.getElementById("inviteInput");
    if (input) input.value = invite;
  }
});



</script>

</body>
</html>
